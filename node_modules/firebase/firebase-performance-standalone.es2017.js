!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).firebase=t()}(this,function(){"use strict";function e(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(let r in n)n.hasOwnProperty(r)&&(t[r]=e(t[r],n[r]));return t}function t(e,t,n){e[t]=n}const n="FirebaseError";class r extends Error{constructor(e,t){super(t),this.code=e,this.name=n,Object.setPrototypeOf(this,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,i.prototype.create)}}class i{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,t={}){const n=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(o,(e,n)=>{const r=t[n];return null!=r?r.toString():`<${n}?>`})}(i,t):"Error",a=`${this.serviceName}: ${s} (${n}).`,c=new r(n,a);for(const e of Object.keys(t))"_"!==e.slice(-1)&&(e in c&&console.warn(`Overwriting FirebaseError base field "${e}" can cause unexpected behavior.`),c[e]=t[e]);return c}}const o=/\{\$([^}]+)}/g,s=new i("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."});function a(e,t){throw s.create(e,t)}const c="[DEFAULT]";class u{constructor(t,n,r){this.firebase_=r,this.isDeleted_=!1,this.services_={},this.INTERNAL={},this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=e(void 0,t)}get automaticDataCollectionEnabled(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_}set automaticDataCollectionEnabled(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e}get name(){return this.checkDestroyed_(),this.name_}get options(){return this.checkDestroyed_(),this.options_}delete(){return new Promise(e=>{this.checkDestroyed_(),e()}).then(()=>{this.firebase_.INTERNAL.removeApp(this.name_);const e=[];for(const t of Object.keys(this.services_))for(const n of Object.keys(this.services_[t]))e.push(this.services_[t][n]);return Promise.all(e.map(e=>e.INTERNAL.delete()))}).then(()=>{this.isDeleted_=!0,this.services_={}})}_getService(e,t=c){if(this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){const n=t!==c?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]}extendApp(t){e(this,t)}checkDestroyed_(){this.isDeleted_&&a("app-deleted",{name:this.name_})}}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const f=function(){const n=function(n){const r={},i={},o={},s={__esModule:!0,initializeApp:function(e,t={}){if("object"!=typeof t||null===t){const e=t;t={name:e}}const i=t;void 0===i.name&&(i.name=c);const{name:o}=i;"string"==typeof o&&o||a("bad-app-name",{name:String(o)}),l(r,o)&&a("duplicate-app",{name:o});const u=new n(e,i,s);return r[o]=u,p(u,"create"),u},app:u,apps:null,Promise:Promise,SDK_VERSION:"5.11.1",INTERNAL:{registerService:function(t,r,c,l,p=!1){function d(e=u()){return"function"!=typeof e[t]&&a("invalid-app-argument",{name:t}),e[t]()}return i[t]&&a("duplicate-service",{name:t}),i[t]=r,l&&(o[t]=l,f().forEach(e=>{l("create",e)})),void 0!==c&&e(d,c),s[t]=d,n.prototype[t]=function(...e){return this._getService.bind(this,t).apply(this,p?e:[])},d},removeApp:function(e){p(r[e],"delete"),delete r[e]},factories:i,useAsService:d}};function u(e){return l(r,e=e||c)||a("no-app",{name:e}),r[e]}function f(){return Object.keys(r).map(e=>r[e])}function p(e,t){for(const n of Object.keys(i)){const r=d(e,n);if(null===r)return;o[r]&&o[r](t,e)}}function d(e,t){if("serverAuth"===t)return null;const n=t;return e.options,n}return t(s,"default",s),Object.defineProperty(s,"apps",{get:f}),t(u,"App",n),s}(u);n.SDK_VERSION="5.11.1_LITE";const r=n.INTERNAL.registerService;return n.INTERNAL.registerService=function(e,t,n,i,o){if("performance"!==e&&"installations"!==e)throw Error(`${e} cannot register with the standalone perf instance`);return r(e,t,n,i,o)},n}();function p(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function d(e,t,n){var r,i=new Promise(function(i,o){p(r=e[t].apply(e,n)).then(i,o)});return i.request=r,i}function h(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function g(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return d(this[t],r,arguments)})})}function m(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function _(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return e=this[t],(n=d(e,r,arguments)).then(function(e){if(e)return new y(e,n.request)});var e,n})})}function b(e){this._index=e}function y(e,t){this._cursor=e,this._request=t}function w(e){this._store=e}function v(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function E(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new v(n)}function I(e){this._db=e}h(b,"_index",["name","keyPath","multiEntry","unique"]),g(b,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),_(b,"_index",IDBIndex,["openCursor","openKeyCursor"]),h(y,"_cursor",["direction","key","primaryKey","value"]),g(y,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(e){e in IDBCursor.prototype&&(y.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then(function(){return t._cursor[e].apply(t._cursor,n),p(t._request).then(function(e){if(e)return new y(e,t._request)})})})}),w.prototype.createIndex=function(){return new b(this._store.createIndex.apply(this._store,arguments))},w.prototype.index=function(){return new b(this._store.index.apply(this._store,arguments))},h(w,"_store",["name","keyPath","indexNames","autoIncrement"]),g(w,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),_(w,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),m(w,"_store",IDBObjectStore,["deleteIndex"]),v.prototype.objectStore=function(){return new w(this._tx.objectStore.apply(this._tx,arguments))},h(v,"_tx",["objectStoreNames","mode"]),m(v,"_tx",IDBTransaction,["abort"]),E.prototype.createObjectStore=function(){return new w(this._db.createObjectStore.apply(this._db,arguments))},h(E,"_db",["name","version","objectStoreNames"]),m(E,"_db",IDBDatabase,["deleteObjectStore","close"]),I.prototype.transaction=function(){return new v(this._db.transaction.apply(this._db,arguments))},h(I,"_db",["name","version","objectStoreNames"]),m(I,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[w,b].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],i=this._store||this._index,o=i[e].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})})}),[b,w].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(i){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)})})})});const S=1e4,T="w:0.1.0",A="FIS_v2",k="https://firebaseinstallations.googleapis.com/v1",N=36e5,O=new i("installations","Installations",{"missing-app-config-values":"Missing App configuration values.","create-installation-failed":"Could not register Firebase Installation.","generate-token-failed":"Could not generate Auth Token.","not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function D(e){return e instanceof r&&e.code.includes("request-failed")}function R(e){if(!e||!e.options)throw O.create("missing-app-config-values");const t=e.name,{projectId:n,apiKey:r,appId:i}=e.options;if(!(t&&n&&r&&i))throw O.create("missing-app-config-values");return{appName:t,projectId:n,apiKey:r,appId:i}}function j({projectId:e}){return`${k}/projects/${e}/installations`}function P(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function $(e,t){const n=(await t.json()).error;return O.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function M({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function C(e,{refreshToken:t}){const n=M(e);return n.append("Authorization",function(e){return`${A} ${e}`}(t)),n}function B(e){return new Promise(t=>{setTimeout(t,e)})}function L(){const e=new Uint8Array(17);return crypto.getRandomValues(e),e[0]=112+e[0]%16,function(e){return function(e){const t=e instanceof Uint8Array?e:new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e)}const U="firebase-installations-store",F=(q=(e=>{switch(e.oldVersion){case 0:e.createObjectStore(U)}}),x=d(indexedDB,"open",["firebase-installations-database",1]),(K=x.request)&&(K.onupgradeneeded=function(e){q&&q(new E(K.result,e.oldVersion,K.transaction))}),x.then(function(e){return new I(e)}));var q,x,K,V;async function H(e,t){const n=z(e),r=(await F).transaction(U,"readwrite");return r.objectStore(U).put(t,n),await r.complete,t}async function W(e){const t=z(e),n=(await F).transaction(U,"readwrite");return n.objectStore(U).delete(t),n.complete}async function J(e,t){const n=z(e),r=(await F).transaction(U,"readwrite"),i=r.objectStore(U),o=await i.get(n),s=t(o);return s===o?s:(void 0===s?i.delete(n):i.put(s,n),await r.complete,s)}function z(e){return`${e.appName}!${e.appId}`}async function G(e){let t;return{installationEntry:await J(e,n=>{const r=function(e){const t=e||{fid:L(),registrationStatus:0};if(Y(t))return{fid:t.fid,registrationStatus:0};return t}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){const e=Promise.reject(O.create("app-offline"));return{installationEntry:t,registrationPromise:e}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,{fid:t}){const n=j(e),r=M(e),i={fid:t,authVersion:A,appId:e.appId,sdkVersion:T},o={method:"POST",headers:r,body:JSON.stringify(i)},s=await fetch(n,o);if(s.ok){const e=await s.json();return{fid:t,registrationStatus:2,refreshToken:e.refreshToken,authToken:P(e.authToken)}}throw $("Create Installation",s)}(e,t);await H(e,n)}catch(n){throw D(n)&&409===n.serverCode?await W(e):await H(e,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Q(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}),registrationPromise:t}}async function Q(e){let t=await X(e);for(;1===t.registrationStatus;)await B(100),t=await X(e);if(0===t.registrationStatus)throw O.create("create-installation-failed")}function X(e){return J(e,e=>{if(!e)throw O.create("installation-not-found");return Y(e)?{fid:e.fid,registrationStatus:0}:e})}function Y(e){return 1===e.registrationStatus&&e.registrationTime+S<Date.now()}async function Z(e,t){const n=function(e,{fid:t}){return`${j(e)}/${t}/authTokens:generate`}(e,t),r=C(e,t),i={installation:{sdkVersion:T}},o={method:"POST",headers:r,body:JSON.stringify(i)},s=await fetch(n,o);if(s.ok){return P(await s.json())}throw $("Generate Auth Token",s)}async function ee(e){const t=R(e);return await async function(e){const{installationEntry:t,registrationPromise:n}=await G(e);if(n)await n;else if(2!==t.registrationStatus)throw O.create("create-installation-failed")}(t),async function(e){let t;const n=await J(e,n=>{if(!ne(n))throw O.create("not-registered");const r=n.authToken;if(function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+N}(e)}(r))return n;if(1===r.requestStatus)return t=async function(e){let t=await te(e);for(;1===t.authToken.requestStatus;)await B(100),t=await te(e);const n=t.authToken;if(0===n.requestStatus)throw O.create("generate-token-failed");return n}(e),n;{if(!navigator.onLine)throw O.create("app-offline");const r=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign({},e,{authToken:t})}(n);return t=async function(e,t){try{const n=await Z(e,t),r=Object.assign({},t,{authToken:n});return await H(e,r),n}catch(n){if(!D(n)||401!==n.serverCode&&404!==n.serverCode){const n=Object.assign({},t,{authToken:{requestStatus:0}});await H(e,n)}else await W(e);throw n}}(e,r),r}});return(t?await t:n.authToken).token}(t)}function te(e){return J(e,e=>{if(!ne(e))throw O.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+S<Date.now()}(e.authToken)?Object.assign({},e,{authToken:{requestStatus:0}}):e})}function ne(e){return void 0!==e&&2===e.registrationStatus}async function re(e,t){const n=function(e,{fid:t}){return`${j(e)}/${t}`}(e,t),r={method:"DELETE",headers:C(e,t)},i=await fetch(n,r);if(!i.ok)throw $("Delete Installation",i)}f.INTERNAL.registerService("installations",e=>(R(e),{app:e,getId:()=>(async function(e){const t=R(e),{installationEntry:n,registrationPromise:r}=await G(t);return r&&r.catch(()=>{}),n.fid})(e),getToken:()=>ee(e),delete:()=>(async function(e){const t=R(e),n=await J(t,e=>{if(!e||0!==e.registrationStatus)return e});if(n){if(1===n.registrationStatus)throw O.create("delete-pending-registration");if(2===n.registrationStatus){if(!navigator.onLine)throw O.create("app-offline");await re(t,n),await W(t)}}})(e)})),function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(V||(V={}));const ie=V.INFO,oe=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString();switch(t){case V.DEBUG:case V.VERBOSE:console.log(`[${r}]  ${e.name}:`,...n);break;case V.INFO:console.info(`[${r}]  ${e.name}:`,...n);break;case V.WARN:console.warn(`[${r}]  ${e.name}:`,...n);break;case V.ERROR:console.error(`[${r}]  ${e.name}:`,...n);break;default:throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)}};class se{constructor(e){this.name=e,this._logLevel=ie,this._logHandler=oe}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in V))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}debug(...e){this._logHandler(this,V.DEBUG,...e)}log(...e){this._logHandler(this,V.VERBOSE,...e)}info(...e){this._logHandler(this,V.INFO,...e)}warn(...e){this._logHandler(this,V.WARN,...e)}error(...e){this._logHandler(this,V.ERROR,...e)}}const ae="0.2.1",ce="FB-PERF-TRACE-START",ue="FB-PERF-TRACE-STOP",le="FB-PERF-TRACE-MEASURE",fe="_wt_",pe="_fp",de="_fcp",he="_fid",ge="@firebase/performance/config",me="@firebase/performance/configexpire",_e=new i("performance","Performance",{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok"});let be,ye,we,ve;class Ee{constructor(e){if(!e)throw _e.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.localStorage=e.localStorage,e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver(e=>{for(const n of e.getEntries())t(n)}).observe({entryTypes:[e]})}static getInstance(){return void 0===be&&(be=new Ee(ye)),be}}class Ie{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getAppId(){const e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!e)throw _e.create("no app id");return e}getProjectId(){const e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!e)throw _e.create("no project id");return e}getApiKey(){const e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!e)throw _e.create("no api key");return e}static getInstance(){return void 0===we&&(we=new Ie),we}}function Se(){return ve}var Te;function Ae(){const e=Ee.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function ke(){switch(Ee.getInstance().document.visibilityState){case"visible":return Te.VISIBLE;case"hidden":return Te.HIDDEN;case"prerender":return Te.PRERENDER;default:return Te.UNKNOWN}}function Ne(){const e=Ee.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN",e[e.PRERENDER=3]="PRERENDER",e[e.UNLOADED=4]="UNLOADED"}(Te||(Te={}));const Oe=new se("Performance");Oe.logLevel=V.INFO;const De="0.0.1",Re={loggingEnabled:!0},je="FIREBASE_INSTALLATIONS_AUTH";function Pe(e){const t=function(){const e=Ee.getInstance().localStorage,t=e.getItem(me);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(ge);if(!r)return;try{const e=JSON.parse(r);return e}catch(e){return}}();return t?(Me(t),Promise.resolve()):function(e){return function(){const e=Ie.getInstance().firebaseAppInstance.installations().getToken();return e.then(e=>{}),e}().then(t=>{const n=Ie.getInstance().getProjectId(),r=`https://firebaseremoteconfig.googleapis.com/v1/projects/${n}/namespaces/fireperf:fetch?key=${Ie.getInstance().getApiKey()}`,i=new Request(r,{method:"POST",headers:{Authorization:`${je} ${t}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:Ie.getInstance().getAppId(),app_version:ae,sdk_version:De})});return fetch(i).then(e=>{if(e.ok)return e.json();throw _e.create("RC response not ok")})}).catch(()=>{Oe.info($e)})}(e).then(e=>Me(e)).then(e=>(function(e){if(!e)return;const t=Ee.getInstance().localStorage;t.setItem(ge,JSON.stringify(e)),t.setItem(me,String(Date.now()+60*Ie.getInstance().configTimeToLive*60*1e3))})(e),()=>{})}const $e="Could not fetch config, will use default configs";function Me(e){if(!e)return e;const t=Ie.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=Re.loggingEnabled,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=Ce(t.tracesSamplingRate),t.logNetworkAfterSampling=Ce(t.networkRequestsSamplingRate),e}function Ce(e){return Math.random()<=e}let Be,Le=1;function Ue(){return Le=2,Be=Be||function(){const e=Ee.getInstance().document;return new Promise(t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()})}().then(()=>(function(){const e=Ie.getInstance().firebaseAppInstance.installations().getId();return e.then(e=>{ve=e}),e})()).then(e=>Pe(e)).then(()=>Fe(),()=>Fe())}function Fe(){Le=3}const qe=1e4,xe=3;let Ke,Ve=xe,He=[];function We(e){return(t,n,...r)=>{!function(e){if(!e.eventTime||!e.message)throw _e.create("invalid cc log");He=[...He,e]}({message:e(...r),eventTime:Date.now()})}}function Je(){if(Ke)return Ke;const e=We(Qe);return(Ke=new se("@firebase/performance/cc")).logHandler=e,Ke}function ze(e){const t=Ie.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&(e.isAuto&&ke()!==Te.VISIBLE||t.loggingEnabled&&t.logTraceAfterSampling&&(3===Le?Ge(e):Ue().then(()=>Ge(e),()=>Ge(e))))}function Ge(e){Se()&&setTimeout(()=>Je().log(e,1),0)}function Qe(e,t){return 0===t?function(e){const t={url:e.url,http_method:1,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:Xe(),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=Ye(e.counters));const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=Ye(n));const r={application_info:Xe(),trace_metric:t};return JSON.stringify(r)}(e)}function Xe(){return{google_app_id:Ie.getInstance().getAppId(),app_instance_id:Se(),web_app_info:{sdk_version:ae,page_url:Ee.getInstance().getUrl(),service_worker_status:Ae(),visibility_state:ke(),effective_connection_type:Ne()},application_process_state:0}}function Ye(e){return Object.keys(e).map(t=>({key:t,value:e[t]}))}!function e(t){setTimeout(()=>{if(0===Ve)return;if(!He.length)return e(qe);const t=[...He];He=[];const n=t.map(e=>({source_extension_json:e.message,event_time_ms:String(e.eventTime)})),r={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Ie.getInstance().logSource,log_event:n};fetch(Ie.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(r)}).then(e=>(e.ok||Oe.info("Call to Firebase backend failed."),e.json())).then(t=>{const n=Math.max(qe,parseInt(t.next_request_wait_millis,10));Ve=xe,e(n)}).catch(()=>{He=[...t,...He],Ve--,Oe.info(`Tries left: ${Ve}.`),e(qe)})},t)}(5500);class Ze{constructor(e,t=!1,n){this.name=e,this.isAuto=t,this.state=1,this.customAttributes={},this.counters={},this.api=Ee.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`${ce}-${this.randomId}-${this.name}`,this.traceStopMark=`${ue}-${this.randomId}-${this.name}`,this.traceMeasure=n||`${le}-${this.randomId}-${this.name}`,n&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw _e.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw _e.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ze(this)}record(e,t,n){if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Number(Math.floor(n.metrics[e])));ze(this)}incrementMetric(e,t=1){void 0===this.counters[e]&&(this.counters[e]=0),this.counters[e]+=t}putMetric(e,t){this.counters[e]=t}getMetric(e){return this.counters[e]||0}putAttribute(e,t){this.customAttributes[e]=t}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n){const r=Ee.getInstance().getUrl();if(!r)return;const i=new Ze(fe+r,!0),o=Math.floor(1e3*Ee.getInstance().getTimeOrigin());i.setStartTime(o),e&&e[0]&&(i.setDuration(Math.floor(1e3*e[0].duration)),i.incrementMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),i.incrementMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),i.incrementMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(t){const e=t.find(e=>"first-paint"===e.name);e&&e.startTime&&i.incrementMetric(pe,Math.floor(1e3*e.startTime));const r=t.find(e=>"first-contentful-paint"===e.name);r&&r.startTime&&i.incrementMetric(de,Math.floor(1e3*r.startTime)),n&&i.incrementMetric(he,Math.floor(1e3*n))}ze(i)}static createUserTimingTrace(e){ze(new Ze(e,!1,e))}}function et(e){const t=e;if(!t||void 0===t.responseStart)return;const n=Ee.getInstance().getTimeOrigin(),r=Math.floor(1e3*(t.startTime+n)),i=t.responseStart?Math.floor(1e3*(t.responseStart-t.startTime)):void 0,o=Math.floor(1e3*(t.responseEnd-t.startTime));!function(e){const t=Ie.getInstance();t.instrumentationEnabled&&e.url!==t.logEndPointUrl.split("?")[0]&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout(()=>Je().log(e,0),0)}({url:t.name&&t.name.split("?")[0],responsePayloadBytes:t.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}const tt=5e3;function nt(){Se()&&(setTimeout(()=>(function(){const e=Ee.getInstance(),t=e.getEntriesByType("navigation"),n=e.getEntriesByType("paint");if(e.onFirstInputDelay){let r=setTimeout(()=>{Ze.createOobTrace(t,n),r=void 0},tt);e.onFirstInputDelay(e=>{r&&(clearTimeout(r),Ze.createOobTrace(t,n,e))})}else Ze.createOobTrace(t,n)})(),0),setTimeout(()=>(function(){const e=Ee.getInstance(),t=e.getEntriesByType("resource");for(const e of t)et(e);e.setupObserver("resource",et)})(),0),setTimeout(()=>(function(){const e=Ee.getInstance(),t=e.getEntriesByType("measure");for(const e of t)rt(e);e.setupObserver("measure",rt)})(),0))}function rt(e){const t=e.name;t.substring(0,le.length)!==le&&Ze.createUserTimingTrace(t)}class it{constructor(e){this.app=e,Ue().then(nt,nt)}trace(e){return new Ze(e)}set instrumentationEnabled(e){Ie.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Ie.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Ie.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Ie.getInstance().dataCollectionEnabled}}const ot="[DEFAULT]";return window&&fetch&&Promise?(function(e){ye=e}(window),function(e){e.INTERNAL.registerService("performance",e=>{if(e.name!==ot)throw _e.create("FB not default");return Ie.getInstance().firebaseAppInstance=e,new it(e)},{})}(f)):Oe.info("Firebase Performance cannot start if browser does not support fetch and Promise."),f});
//# sourceMappingURL=firebase-performance-standalone.es2017.js.map
